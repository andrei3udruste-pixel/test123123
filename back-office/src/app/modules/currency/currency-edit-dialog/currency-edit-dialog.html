<h2 mat-dialog-title>{{ 'currency.edit.title' | translate }}</h2>

<mat-dialog-content>
  <div class="mb-4">
    <p class="text-sm text-gray-500">{{ 'currency.code' | translate }}: <strong>{{ currency.code }}</strong></p>
    <p class="text-sm text-gray-500">{{ 'currency.name' | translate }}: <strong>{{ currency.name }}</strong></p>
  </div>

  <form [formGroup]="form" class="flex flex-col gap-4">
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>{{ 'currency.buyingConversion' | translate }}</mat-label>
      <input matInput type="number" formControlName="buyingConversion" step="0.000001" min="0" />
      <mat-hint>{{ 'currency.buyingConversion.hint' | translate }}</mat-hint>
      @if (form.controls.buyingConversion.hasError('required')) {
        <mat-error>{{ 'error.form.required' | translate }}</mat-error>
      }
      @if (form.controls.buyingConversion.hasError('min')) {
        <mat-error>{{ 'currency.error.conversionMin' | translate }}</mat-error>
      }
    </mat-form-field>

    <div class="m-1"></div>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>{{ 'currency.sellingConversion' | translate }}</mat-label>
      <input matInput type="number" formControlName="sellingConversion" step="0.000001" min="0" />
      <mat-hint>{{ 'currency.sellingConversion.hint' | translate }}</mat-hint>
      @if (form.controls.sellingConversion.hasError('required')) {
        <mat-error>{{ 'error.form.required' | translate }}</mat-error>
      }
      @if (form.controls.sellingConversion.hasError('min')) {
        <mat-error>{{ 'currency.error.conversionMin' | translate }}</mat-error>
      }
    </mat-form-field>

    @if (form.valid && (form.value.buyingConversion ?? 0) <= (form.value.sellingConversion ?? 0)) {
      <div class="text-red-500 text-sm">
        {{ 'currency.error.buyingMustBeGreater' | translate }}
      </div>
    }
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-stroked-button (click)="onCancel()" [disabled]="isSubmitting">
    {{ 'actions.cancel' | translate }}
  </button>
  <button mat-flat-button color="primary" (click)="onSave()" [disabled]="!isValid() || isSubmitting">
    @if (isSubmitting) {
      <mat-spinner diameter="20"></mat-spinner>
    } @else {
      {{ 'actions.save' | translate }}
    }
  </button>
</mat-dialog-actions>
